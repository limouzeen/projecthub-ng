<section class="p-6 space-y-6">
  <div class="flex justify-between items-center">
    <h1 class="text-xl font-semibold">Table #{{ tableId }}</h1>
    <div class="space-x-2">
      <button class="btn-primary-enhance" (click)="onAddField()">Add Field</button>
      <button
        (click)="onAddRow()"
        [disabled]="columns().length === 0"
        [ngClass]="{
          'btn-primary-enhance': columns().length > 0,
          'btn-disabled': columns().length === 0
        }"
        [title]="columns().length === 0 ? 'Add at least one field first' : ''"
      >
        Add Row
      </button>
    </div>
  </div>

  <div class="grid-wrap">
    <div #tabGrid class="tab-root w-full h-[calc(100vh-260px)]"></div>
  </div>

  <div class="mt-2">
    <div class="text-slate-600 text-sm font-semibold mb-1">Fields</div>
    <ul class="space-y-1">
      @for (c of columns(); track c.columnId) {
        <li class="flex justify-between text-sm">
          <span>
            {{ c.name }}
            <small class="text-slate-400">({{ c.dataType }})</small>
            @if (c.isPrimary) { <small class="text-slate-400">â€” PK</small> }
          </span>
          <span class="flex gap-3">
            <button class="link" (click)="onEditField(c)">Edit</button>
            <button class="link link-danger" (click)="onDeleteField(c)">Delete</button>
          </span>
        </li>
      }
    </ul>
  </div>

  <ph-field-dialog
    [open]="fieldOpen()"
    [tableId]="tableId"
    (save)="onSaveField($event)"
    (cancel)="fieldOpen.set(false)">
  </ph-field-dialog>

  <ph-row-dialog
    [open]="rowOpen()"
    [tableId]="tableId"
    [columns]="columns()"
    [initData]="rowInitData"
    [isAutoTable]="isAutoTable()"
    (save)="onSaveRow($event)"
    (cancel)="rowOpen.set(false)">
  </ph-row-dialog>
</section>
